$("table").each(function (index) { var table = $(this); $("tr th", table).each(function (index) { $(this).click(function (je) { var rows = $("tr", table).has("td"), col = index, order; if ($("tr th", table).eq(index).has("img").length != 0 && $("img", $("tr th", table).eq(index)).attr("src").indexOf("ascend.png") != -1) { order = "desc"; } else { order = "asc"; } var sortedRows = _.sortByOrder(rows.toArray(), function (it) { return $("td", it).eq(col).text(); }, order); var container = $("tr td", table).closest("tbody,table"); rows.remove(); for (var i = 0; i < sortedRows.length; ++i) { container.append(sortedRows[i]); } $("tr th img", table).remove(); $("tr th", table).eq(index).append("<img src='http://perqin.com/mwp/sorter/" + order + "end.png'/>"); }); }); });